# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Test and report
'on':
  push:
    branches:
      - main

jobs:
  test_and_report:
    runs-on: ubuntu-latest
    container:
      image: ghcr.io/cirruslabs/flutter:3.10.2
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Check flutter version
        run: flutter --version
      - run: wget https://raw.githubusercontent.com/priezz/dart_full_coverage/master/dart-coverage-helper
      - run: chmod +x dart-coverage-helper
      - run: ./dart-coverage-helper
      - name: Run test
        run: flutter test --coverage
      - name: Upload coverage reports to Codecov
        uses: codecov/codecov-action@v3
        with:
          token: ${{ secrets.CODECOV_TOKEN }}
          files: ./coverage/lcov.info
